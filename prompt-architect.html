<!DOCTYPE html>
<html lang="en">

<head>
    <base href="/">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prompt Architect - uniQue-ue</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts (Inter & Orbitron) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Orbitron:wght@700;800;900&display=swap" rel="stylesheet">
    
    <!-- Global Stylesheet -->
    <link rel="stylesheet" href="style.css">
    
    <!-- jsPDF for PDF Export -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    
    <!-- Firebase & Main App Logic -->
    <script src="firebase-config.js" type="module"></script>
    <script src="app.js" type="module"></script>
    
    <link rel="icon" href="uniQ_logo_sm2T.png" type="image/png">
</head>

<body>
    <!-- Fixed background particle canvas -->
    <canvas id="particle-canvas" class="particle-canvas"></canvas>
    
    <!-- Page Wrapper -->
    <div class="page-wrapper">
    
        <!-- Global Header Component -->
        <div id="header-placeholder">
            <div class="fixed top-0 left-0 right-0 z-50 h-20 bg-brand-secondary/50 backdrop-blur-md animate-pulse"></div>
        </div>
        
        <!-- Main Content -->
        <main class="container mx-auto px-6 py-12">
            
            <!-- App State: Landing -->
            <div id="landing-state" class="animate-fade-in-up">
                <div class="text-center mb-12">
                    <div class="hero-logo-container">
                        <img src="/uniQ_logo_sm2T.png" alt="uniQue-ue Logo" id="hero-logo" class="hero-logo transition-transform duration-200 ease-out">
                    </div>
                    <div class="inline-block px-4 py-1.5 bg-brand-accent/10 border border-brand-accent/40 rounded-full text-xs font-display text-brand-accent tracking-widest mb-4">
                        PROTOCOL: CAPACITIVE_ARCHITECT // PHASE 2025.Q4
                    </div>
                    <h1 class="text-5xl md:text-7xl font-display font-bold mb-6 heading-glow">
                        MASTER<br>
                        <span class="text-transparent bg-clip-text bg-gradient-to-r from-brand-accent via-blue-500 to-brand-magenta">INSTRUCTIONS</span>
                    </h1>
                    <p class="text-xl md:text-2xl text-brand-text-muted max-w-3xl mx-auto mb-8">
                        Engineer high-fidelity prompts with neural precision. Optimized for the world's most advanced reasoning models.
                    </p>
                    <button onclick="startQuestionnaire()" class="group relative px-12 py-6 bg-brand-accent hover:brightness-110 text-brand-primary font-display text-xl rounded-sm transition-all shadow-[0_0_30px_rgba(0,246,255,0.4)] hover:shadow-[0_0_50px_rgba(0,246,255,0.7)]">
                        <span class="relative flex items-center gap-4">
                            INITIALIZE ARCHITECT
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="m9 18 6-6-6-6"/>
                            </svg>
                        </span>
                    </button>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-10 max-w-6xl mx-auto mt-24">
                    <div class="panel-3d p-10 text-left hover:bg-brand-secondary/50 transition-all transform hover:-translate-y-1 border-l-4 border-brand-accent">
                        <svg xmlns="http://www.w3.org/2000/svg" class="text-brand-accent w-10 h-10 mb-8" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <rect width="16" height="16" x="4" y="4" rx="2"/>
                            <rect width="6" height="6" x="9" y="9" rx="1"/>
                            <path d="M15 2v2"/>
                            <path d="M15 20v2"/>
                            <path d="M2 15h2"/>
                            <path d="M2 9h2"/>
                            <path d="M20 15h2"/>
                            <path d="M20 9h2"/>
                            <path d="M9 2v2"/>
                            <path d="M9 20v2"/>
                        </svg>
                        <h3 class="font-display text-lg mb-4 text-white tracking-widest">Neural Sync</h3>
                        <p class="text-brand-text-muted text-md leading-relaxed">Cross-compatible optimization for Gemini, GPT, and Claude architectures.</p>
                    </div>
                    
                    <div class="panel-3d p-10 text-left hover:bg-brand-secondary/50 transition-all transform hover:-translate-y-1 border-l-4 border-brand-magenta">
                        <svg xmlns="http://www.w3.org/2000/svg" class="text-brand-magenta w-10 h-10 mb-8" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <polyline points="4 17 10 11 4 5"/>
                            <line x1="12" x2="20" y1="19" y2="19"/>
                        </svg>
                        <h3 class="font-display text-lg mb-4 text-white tracking-widest">Context Mapping</h3>
                        <p class="text-brand-text-muted text-md leading-relaxed">Deep extraction of requirements using capacitive reasoning chains.</p>
                    </div>
                    
                    <div class="panel-3d p-10 text-left hover:bg-brand-secondary/50 transition-all transform hover:-translate-y-1 border-l-4 border-emerald-400">
                        <svg xmlns="http://www.w3.org/2000/svg" class="text-emerald-400 w-10 h-10 mb-8" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <rect width="18" height="18" x="3" y="3" rx="2"/>
                            <path d="M7 7h10"/>
                            <path d="M7 12h10"/>
                            <path d="M7 17h10"/>
                        </svg>
                        <h3 class="font-display text-lg mb-4 text-white tracking-widest">Export Suite</h3>
                        <p class="text-brand-text-muted text-md leading-relaxed">Clean PDF serialization with structured architectural breakdowns.</p>
                    </div>
                </div>
            </div>
            
            <!-- App State: Questionnaire -->
            <div id="questionnaire-state" class="hidden">
                <div class="max-w-5xl mx-auto panel-3d p-12">
                    <div class="flex items-center justify-between mb-12 border-b border-brand-accent/20 pb-8">
                        <div class="flex items-center gap-5">
                            <svg xmlns="http://www.w3.org/2000/svg" class="text-brand-accent w-8 h-8" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"/>
                                <circle cx="12" cy="12" r="3"/>
                            </svg>
                            <h2 class="text-4xl font-display heading-glow tracking-tighter uppercase">Config_Session</h2>
                        </div>
                        <div class="text-xs font-mono text-brand-accent uppercase tracking-widest">
                            System: Active // Neural Link: 100%
                        </div>
                    </div>
                    
                    <div id="error-message" class="hidden mb-10 p-5 bg-red-900/30 border border-red-500/50 rounded-sm flex items-center gap-4 text-red-100">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="12" cy="12" r="10"/>
                            <line x1="12" x2="12" y1="8" y2="12"/>
                            <line x1="12" x2="12.01" y1="16" y2="16"/>
                        </svg>
                        <span class="text-sm font-mono uppercase tracking-tight" id="error-text"></span>
                    </div>

                    <form id="prompt-form" class="space-y-12">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-12">
                            <div class="group">
                                <label class="flex items-center gap-3 text-base font-display font-bold text-brand-accent uppercase tracking-widest mb-4">
                                    Persona Assignment
                                    <svg xmlns="http://www.w3.org/2000/svg" class="text-brand-accent/70 w-4 h-4" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <circle cx="12" cy="12" r="10"/>
                                        <path d="M12 16v-4"/>
                                        <path d="M12 8h.01"/>
                                    </svg>
                                </label>
                                <div class="bg-brand-accent/10 border-l-2 border-brand-accent p-4 mb-4">
                                    <p class="text-sm text-brand-text leading-relaxed italic">
                                        Define the AI's core identity (e.g., "Full-Stack Security Auditor" or "Creative Narrative Strategist").
                                    </p>
                                </div>
                                <input 
                                    type="text"
                                    id="role"
                                    placeholder="e.g. Expert Senior Prompt Architect"
                                    class="w-full bg-brand-primary border-2 border-brand-secondary p-5 focus:outline-none focus:border-brand-accent focus:bg-brand-secondary/50 transition-all font-mono text-xl text-brand-text placeholder:text-brand-text-muted/50"
                                />
                            </div>
                            
                            <div>
                                <label class="text-base font-display font-bold text-brand-accent uppercase tracking-widest mb-4 block">Vocal Signature (Tone)</label>
                                <div class="bg-brand-accent/10 border-l-2 border-brand-accent p-4 mb-4">
                                    <p class="text-sm text-brand-text leading-relaxed italic">
                                        Controls the complexity and emotional resonance of the generated content.
                                    </p>
                                </div>
                                <select 
                                    id="tone"
                                    class="w-full bg-brand-primary border-2 border-brand-secondary p-5 focus:outline-none focus:border-brand-accent focus:bg-brand-secondary/50 transition-all font-mono text-xl text-brand-text appearance-none form-select-styled"
                                >
                                    <option>Professional & Efficient</option>
                                    <option>Creative & Narrative</option>
                                    <option>Technical & Verbose</option>
                                    <option>Socratic & Probing</option>
                                    <option>Minimalist & Direct</option>
                                </select>
                            </div>
                        </div>

                        <div>
                            <label class="text-base font-display font-bold text-brand-accent uppercase tracking-widest mb-4 block">Primary Mission</label>
                            <div class="bg-brand-accent/10 border-l-2 border-brand-accent p-4 mb-4">
                                <p class="text-sm text-brand-text leading-relaxed italic">
                                    Specify exactly what you want the AI to generate or analyze. Be specific about the "What".
                                </p>
                            </div>
                            <textarea 
                                id="task"
                                rows="3"
                                placeholder="I need a technical breakdown of..."
                                class="w-full bg-brand-primary border-2 border-brand-secondary p-5 focus:outline-none focus:border-brand-accent focus:bg-brand-secondary/50 transition-all font-mono text-xl text-brand-text placeholder:text-brand-text-muted/50"
                            ></textarea>
                        </div>

                        <div>
                            <label class="text-base font-display font-bold text-brand-accent uppercase tracking-widest mb-4 block">Environmental Context</label>
                            <div class="bg-brand-accent/10 border-l-2 border-brand-accent p-4 mb-4">
                                <p class="text-sm text-brand-text leading-relaxed italic">
                                    Provide background info, target audience, or current challenges that the AI must account for.
                                </p>
                            </div>
                            <textarea 
                                id="context"
                                rows="4"
                                placeholder="Background info..."
                                class="w-full bg-brand-primary border-2 border-brand-secondary p-5 focus:outline-none focus:border-brand-accent focus:bg-brand-secondary/50 transition-all font-mono text-xl text-brand-text placeholder:text-brand-text-muted/50"
                            ></textarea>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-12">
                            <div>
                                <label class="text-base font-display font-bold text-brand-accent uppercase tracking-widest mb-4 block">Operational Constraints</label>
                                <div class="bg-brand-accent/10 border-l-2 border-brand-accent p-4 mb-4">
                                    <p class="text-sm text-brand-text leading-relaxed italic">
                                        List forbidden topics, word counts, or formatting "no-gos".
                                    </p>
                                </div>
                                <textarea 
                                    id="constraints"
                                    rows="2"
                                    placeholder="No generic fluff..."
                                    class="w-full bg-brand-primary border-2 border-brand-secondary p-5 focus:outline-none focus:border-brand-accent focus:bg-brand-secondary/50 transition-all font-mono text-xl text-brand-text placeholder:text-brand-text-muted/50"
                                ></textarea>
                            </div>
                            
                            <div>
                                <label class="text-base font-display font-bold text-brand-accent uppercase tracking-widest mb-4 block">Format Protocol</label>
                                <div class="bg-brand-accent/10 border-l-2 border-brand-accent p-4 mb-4">
                                    <p class="text-sm text-brand-text leading-relaxed italic">
                                        How should the final output be presented (e.g. Table, JSON, Technical README)?
                                    </p>
                                </div>
                                <textarea 
                                    id="outputFormat"
                                    rows="2"
                                    placeholder="Clean Markdown..."
                                    class="w-full bg-brand-primary border-2 border-brand-secondary p-5 focus:outline-none focus:border-brand-accent focus:bg-brand-secondary/50 transition-all font-mono text-xl text-brand-text placeholder:text-brand-text-muted/50"
                                ></textarea>
                            </div>
                        </div>

                        <button 
                            type="submit"
                            id="generate-btn"
                            class="w-full py-8 bg-gradient-to-r from-brand-accent via-brand-accent to-blue-600 hover:brightness-110 text-brand-primary font-display text-2xl tracking-widest shadow-2xl transition-all flex items-center justify-center gap-6 group relative overflow-hidden"
                        >
                            <div class="absolute inset-0 bg-white/10 translate-x-[-100%] group-hover:translate-x-[100%] transition-transform duration-1000"></div>
                            <svg xmlns="http://www.w3.org/2000/svg" class="group-hover:translate-x-3 transition-transform" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="m22 2-7 20-4-9-9-4Z"/>
                                <path d="M22 2 11 13"/>
                            </svg>
                            EXECUTE_GENERATION_PROTOCOLS
                        </button>
                    </form>
                </div>
            </div>
            
            <!-- App State: Generating -->
            <div id="generating-state" class="hidden flex flex-col items-center justify-center mt-36 space-y-12">
                <div class="relative w-48 h-48">
                    <div class="absolute inset-0 border-4 border-brand-accent/10 rounded-full"></div>
                    <div class="absolute inset-0 border-t-4 border-brand-accent rounded-full animate-spin"></div>
                    <div class="absolute inset-6 border-4 border-brand-magenta/10 rounded-full"></div>
                    <div class="absolute inset-6 border-b-4 border-brand-magenta rounded-full animate-[spin_4s_linear_infinite_reverse]"></div>
                    <div class="absolute inset-0 flex items-center justify-center">
                        <svg xmlns="http://www.w3.org/2000/svg" class="text-brand-accent w-16 h-16 animate-pulse" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z"/>
                            <path d="M9 13a4.5 4.5 0 0 0 3-4"/>
                            <path d="M6.003 5.125A3 3 0 0 0 6.401 6.5"/>
                            <path d="M3.477 10.896a4 4 0 0 1 .585-.396"/>
                            <path d="M6 18a4 4 0 0 1-1.967-.516"/>
                            <path d="M12 13h4"/>
                            <path d="M12 18h6a2 2 0 0 1 2 2v1"/>
                            <path d="M12 8h8"/>
                            <path d="M16 8V5a2 2 0 0 1 2-2"/>
                            <circle cx="16" cy="13" r=".5"/>
                            <circle cx="18" cy="3" r=".5"/>
                            <circle cx="20" cy="21" r=".5"/>
                            <circle cx="20" cy="8" r=".5"/>
                        </svg>
                    </div>
                </div>
                <div class="text-center space-y-6">
                    <p class="font-display text-4xl tracking-widest text-white">SYNTHESIZING_ARCHITECT</p>
                    <div class="font-mono text-sm text-brand-accent/70 flex items-center justify-center gap-4">
                        <span class="animate-bounce">●</span>
                        <span class="animate-bounce" style="animation-delay: 0.15s">●</span>
                        <span class="animate-bounce" style="animation-delay: 0.3s">●</span>
                        MAPPING_LATENT_REQUIREMENTS
                    </div>
                </div>
            </div>
            
            <!-- App State: Editor -->
            <div id="editor-state" class="hidden">
                <div class="grid grid-cols-1 lg:grid-cols-12 gap-12">
                    
                    <!-- Sidebar -->
                    <div class="lg:col-span-3 space-y-8">
                        <div class="flex flex-col gap-3 mb-8">
                            <h3 class="font-display text-xs text-brand-accent uppercase tracking-widest">Architectural Models</h3>
                            <div class="h-px bg-gradient-to-r from-brand-accent to-transparent"></div>
                        </div>
                        <div id="model-list" class="space-y-4">
                            <!-- Model buttons will be inserted here -->
                        </div>
                        
                        <div class="mt-16 p-8 panel-3d border-t-2 border-brand-accent/30">
                            <div class="flex items-center gap-3 mb-6">
                                <svg xmlns="http://www.w3.org/2000/svg" class="text-brand-accent w-5 h-5" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <circle cx="12" cy="12" r="10"/>
                                    <path d="M12 16v-4"/>
                                    <path d="M12 8h.01"/>
                                </svg>
                                <h4 class="text-xs font-display text-brand-text uppercase tracking-widest">Logic Stream Guidance</h4>
                            </div>
                            <p id="overall-guidance" class="text-sm text-brand-text/80 leading-relaxed font-mono"></p>
                        </div>
                    </div>

                    <!-- Editor -->
                    <div class="lg:col-span-9 space-y-10">
                        <div class="panel-3d overflow-hidden shadow-2xl border border-brand-accent/20">
                            <div class="bg-brand-primary px-10 py-6 border-b border-brand-secondary flex justify-between items-center">
                                <div class="flex items-center gap-8">
                                    <div class="font-mono text-xs text-brand-accent/70 tracking-widest uppercase">Matrix // v2025.ARCH</div>
                                    <h2 id="current-model-name" class="font-display text-xl tracking-tight text-white"></h2>
                                </div>
                                <div class="flex items-center gap-8">
                                    <button 
                                        onclick="copyToClipboard()"
                                        class="text-xs font-display text-brand-text-muted hover:text-brand-accent transition-colors flex items-center gap-3 border border-brand-secondary px-5 py-2.5 rounded-sm"
                                    >
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                            <rect width="14" height="14" x="8" y="8" rx="2" ry="2"/>
                                            <path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"/>
                                        </svg>
                                        COPY_STREAM
                                    </button>
                                    <button 
                                        onclick="downloadPDF()"
                                        class="bg-brand-accent hover:brightness-110 text-brand-primary px-8 py-3 text-xs font-display font-bold tracking-widest flex items-center gap-3 transition-all shadow-[0_0_20px_rgba(0,246,255,0.5)]"
                                    >
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                                            <polyline points="7 10 12 15 17 10"/>
                                            <line x1="12" x2="12" y1="15" y2="3"/>
                                        </svg>
                                        EXPORT_PDF
                                    </button>
                                </div>
                            </div>

                            <div class="relative group">
                                <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-brand-accent/50 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"></div>
                                <textarea
                                    id="prompt-editor"
                                    class="w-full h-[650px] bg-brand-primary/60 p-12 font-mono text-lg leading-relaxed text-brand-text focus:outline-none resize-none selection:bg-brand-accent/50"
                                    spellcheck="false"
                                ></textarea>
                                <div class="absolute bottom-8 right-10 pointer-events-none flex items-center gap-3 opacity-40">
                                    <div class="w-3 h-3 rounded-full bg-brand-accent animate-pulse"></div>
                                    <p class="text-xs font-display text-brand-accent uppercase tracking-widest">LIVE_NEURAL_STREAM_SYNC</p>
                                </div>
                            </div>
                        </div>

                        <div class="flex justify-between items-center px-6">
                            <div class="flex gap-6">
                                <div class="h-12 w-px bg-brand-secondary"></div>
                                <div class="flex flex-col justify-center">
                                    <p class="text-xs font-display text-brand-text-muted uppercase tracking-widest">Status: Ready for Injection</p>
                                    <p class="text-xs font-mono text-brand-accent/70 uppercase">Year: 2025 // Horizon: 2026.PROTO</p>
                                </div>
                            </div>
                            <button 
                                onclick="resetToQuestionnaire()"
                                class="text-xs font-display text-brand-accent/70 hover:text-brand-accent flex items-center gap-3 transition-all group"
                            >
                                <svg xmlns="http://www.w3.org/2000/svg" class="group-hover:-rotate-90 transition-transform" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <path d="M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/>
                                    <path d="M3 3v5h5"/>
                                    <path d="M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16"/>
                                    <path d="M16 21h5v-5"/>
                                </svg>
                                RE-CONFIGURE_ARCHITECT
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </main>
        
        <!-- Global Footer Component -->
        <div id="footer-placeholder">
            <div class="h-32 w-full bg-brand-primary border-t border-brand-accent/10 animate-pulse"></div>
        </div>
        
    </div>

    <!-- Page-Specific JavaScript -->
    <script>
        // App State Management
        let currentState = 'landing';
        let currentResults = null;
        let selectedPromptIndex = 0;
        
        // API Configuration - Use Cloudflare Worker endpoint
        const API_ENDPOINT = '/api/generate-prompts';
        
        // State Management Functions
        function setState(newState) {
            // Hide all states
            document.getElementById('landing-state').classList.add('hidden');
            document.getElementById('questionnaire-state').classList.add('hidden');
            document.getElementById('generating-state').classList.add('hidden');
            document.getElementById('editor-state').classList.add('hidden');
            
            // Show requested state
            if (newState === 'landing') {
                document.getElementById('landing-state').classList.remove('hidden');
            } else if (newState === 'questionnaire') {
                document.getElementById('questionnaire-state').classList.remove('hidden');
            } else if (newState === 'generating') {
                document.getElementById('generating-state').classList.remove('hidden');
            } else if (newState === 'editor') {
                document.getElementById('editor-state').classList.remove('hidden');
            }
            
            currentState = newState;
        }
        
        function startQuestionnaire() {
            setState('questionnaire');
        }
        
        function resetToQuestionnaire() {
            setState('questionnaire');
        }
        
        function showError(message) {
            const errorEl = document.getElementById('error-message');
            const errorText = document.getElementById('error-text');
            errorText.textContent = message;
            errorEl.classList.remove('hidden');
            
            setTimeout(() => {
                errorEl.classList.add('hidden');
            }, 5000);
        }
        
        // Form Submission
        document.getElementById('prompt-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const formData = {
                role: document.getElementById('role').value || 'Expert AI Assistant',
                task: document.getElementById('task').value,
                context: document.getElementById('context').value || 'Standard operational environment',
                constraints: document.getElementById('constraints').value || 'Prioritize factual density and clarity',
                outputFormat: document.getElementById('outputFormat').value || 'Structured Markdown',
                tone: document.getElementById('tone').value
            };
            
            if (!formData.task) {
                showError('Primary Mission is required');
                return;
            }
            
            setState('generating');
            
            try {
                // Call API endpoint
                const response = await fetch(API_ENDPOINT, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(formData)
                });
                
                if (!response.ok) {
                    throw new Error('Failed to generate prompts. Please try again.');
                }
                
                const results = await response.json();
                currentResults = results;
                renderEditor();
                setState('editor');
                
            } catch (error) {
                console.error('Generation error:', error);
                showError(error.message || 'NEURAL_LINK_FAILURE: Unable to generate prompts');
                setState('questionnaire');
            }
        });
        
        // Editor Rendering
        function renderEditor() {
            if (!currentResults || !currentResults.variations) return;
            
            // Render model list
            const modelList = document.getElementById('model-list');
            modelList.innerHTML = '';
            
            currentResults.variations.forEach((variation, index) => {
                const button = document.createElement('button');
                button.className = `w-full text-left p-6 transition-all flex items-center justify-between border-l-4 ${
                    selectedPromptIndex === index 
                        ? 'bg-brand-accent/10 border-brand-accent text-white shadow-xl' 
                        : 'bg-brand-primary border-brand-secondary text-brand-text-muted hover:border-brand-accent/50'
                }`;
                
                const iconSvg = getModelIcon(variation.modelName);
                
                button.innerHTML = `
                    <div class="flex items-center gap-5">
                        <div class="${selectedPromptIndex === index ? 'text-brand-accent' : 'text-brand-secondary'}">
                            ${iconSvg}
                        </div>
                        <span class="text-base font-display tracking-tight">${variation.modelName}</span>
                    </div>
                    ${selectedPromptIndex === index ? '<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-brand-accent"><path d="m9 18 6-6-6-6"/></svg>' : ''}
                `;
                
                button.onclick = () => selectPrompt(index);
                modelList.appendChild(button);
            });
            
            // Render selected prompt
            selectPrompt(selectedPromptIndex);
            
            // Render overall guidance
            document.getElementById('overall-guidance').textContent = currentResults.overallGuidance || 'Use these prompts to guide AI models toward optimal performance.';
        }
        
        function getModelIcon(modelName) {
            if (modelName.includes('Gemini')) {
                return '<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2v4m0 12v4M4.93 4.93l2.83 2.83m8.48 8.48 2.83 2.83M2 12h4m12 0h4M4.93 19.07l2.83-2.83m8.48-8.48 2.83-2.83"/></svg>';
            } else if (modelName.includes('Claude')) {
                return '<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z"/><path d="M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z"/><path d="M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4"/><path d="M17.599 6.5a3 3 0 0 0 .399-1.375"/><path d="M6.003 5.125A3 3 0 0 0 6.401 6.5"/></svg>';
            } else {
                return '<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="4 17 10 11 4 5"/><line x1="12" x2="20" y1="19" y2="19"/></svg>';
            }
        }
        
        function selectPrompt(index) {
            selectedPromptIndex = index;
            const variation = currentResults.variations[index];
            
            document.getElementById('current-model-name').textContent = variation.modelName;
            document.getElementById('prompt-editor').value = variation.content;
            
            renderEditor();
        }
        
        // Copy to Clipboard
        function copyToClipboard() {
            const editor = document.getElementById('prompt-editor');
            editor.select();
            document.execCommand('copy');
            
            // Show feedback
            const btn = event.target.closest('button');
            const originalText = btn.innerHTML;
            btn.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg> COPIED!';
            
            setTimeout(() => {
                btn.innerHTML = originalText;
            }, 2000);
        }
        
        // PDF Export
        function downloadPDF() {
            if (!currentResults || !window.jspdf) return;
            
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            const prompt = currentResults.variations[selectedPromptIndex];
            
            doc.setFont("helvetica", "bold");
            doc.setFontSize(22);
            doc.setTextColor(0, 246, 255);
            doc.text("uniQue-ue Prompt Architect", 10, 20);
            
            doc.setFont("helvetica", "normal");
            doc.setFontSize(10);
            doc.setTextColor(100);
            doc.text(`Model Optimization: ${prompt.modelName} | System Date: 2025.Q4`, 10, 28);
            
            doc.setLineWidth(0.5);
            doc.setDrawColor(0, 246, 255);
            doc.line(10, 32, 200, 32);

            doc.setFontSize(12);
            doc.setTextColor(30);
            const splitText = doc.splitTextToSize(prompt.content, 180);
            doc.text(splitText, 10, 45);
            
            doc.setFontSize(9);
            doc.setTextColor(150);
            doc.text("Generated by uniQue-ue.com - High Fidelity Capacitive Intelligence", 10, 285);
            
            doc.save(`unique-ue-master-${prompt.modelName.toLowerCase().replace(/\s+/g, '-')}.pdf`);
        }
        
        // Make functions globally available
        window.startQuestionnaire = startQuestionnaire;
        window.resetToQuestionnaire = resetToQuestionnaire;
        window.copyToClipboard = copyToClipboard;
        window.downloadPDF = downloadPDF;
        window.selectPrompt = selectPrompt;
    </script>
    
    <!-- Logo Mouse-Follow -->
    <script type="module">
        import { auth, db } from './firebase-config.js';
        
        const heroLogo = document.getElementById('hero-logo');
        
        if (heroLogo) {
            const container = heroLogo.parentElement;
            container.addEventListener('mousemove', (e) => {
                const { clientX, clientY } = e;
                const rect = container.getBoundingClientRect();
                const x = ((clientX - rect.left) / rect.width) - 0.5;
                const y = ((clientY - rect.top) / rect.height) - 0.5;
                heroLogo.style.transform = `perspective(1000px) rotateY(${x * 30}deg) rotateX(${-y * 30}deg) scale(1.1)`;
            });
            container.addEventListener('mouseleave', () => {
                heroLogo.style.transform = 'perspective(1000px) rotateY(0deg) rotateX(0deg) scale(1)';
            });
        }
    </script>
</body>

</html>